<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Escolar</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.21.0/dist/umd/supabase.min.js" defer></script> <!-- Usamos defer -->
    <style>
        /* Estilos para el cuerpo y el fondo */
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 0;
            background-image: url('background.jpg');
            background-size: cover;
            background-attachment: fixed;
            text-align: center;
        }

        /* Estilos para el encabezado y el pie de página */
        header, footer {
            background-color: #8B0000;
            color: white;
            padding: 1.5em 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        header {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1em 3em;
        }

        header img {
            width: 100px;  /* Ajuste del tamaño del logo */
            height: auto;
            margin-right: 20px;
        }

        header h1 {
            font-size: 2em;
            margin: 0;
        }

        /* Estilos para la navegación */
        nav ul {
            list-style: none;
            padding: 0;
            text-align: center;
            background-color: #A52A2A;
            margin: 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        nav ul li {
            display: inline;
        }

        nav ul li a {
            color: white;
            padding: 1em;
            display: inline-block;
            text-decoration: none;
            transition: background-color 0.3s;
        }

        nav ul li a:hover {
            background-color: #8B0000;
        }

        /* Estilos para el contenido principal */
        main {
            padding: 2em;
            max-width: 1000px;
            margin: 20px auto;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .container {
            margin: 20px auto;
            padding: 1em;
        }

        /* Estilos para los formularios */
        form {
            background-color: #A52A2A; /* Fondo rojo para los formularios */
            color: white;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            text-align: center;
            height: auto;
            max-width: 700px;
            margin: 20px auto;
        }

        form label {
            display: block;
            margin: 12px 0 8px;
            font-weight: bold;
        }

        form input, form select, form button {
            width: 80%;
            padding: 18px;
            margin: 12px auto;
            border-radius: 8px;
            border: 1px solid #ccc;
            box-sizing: border-box;
            font-size: 16px;
        }

        form input:focus, form select:focus, form button:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 8px rgba(0, 123, 255, 0.25);
        }

        form select, form button {
            cursor: pointer;
        }

        form button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 18px;
            transition: background-color 0.3s;
        }

        form button:hover {
            background-color: #0056b3;
        }

        /* Estilos para los resultados */
        .results {
            margin-top: 20px;
            margin-left: 20%; /* Agregar margen a la izquierda para mover el contenedor hacia la derecha */
            width: 60%; /* Definir un ancho para que ocupe menos espacio y se vea centrado a la derecha */
        }

        /* Estilos para cada resultado */
        .result {
            border: 1px solid #8B0000;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%; /* Hacer que cada resultado ocupe todo el ancho del contenedor */
        }

        /* Estilos para la carga */
        .loading-dots {
            display: none;
        }

        .loading-dots span {
            display: inline-block;
            height: 12px;
            width: 12px;
            margin: 3px;
            background-color: #333;
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        /* Estilos para la información adicional */
        .information {
            text-align: left;
            margin: 20px auto;
            padding: 20px;
            max-width: 1000px; /* Ajustado el ancho máximo para que coincida con los otros contenedores */
            background-color: #ffffff; /* Fondo blanco */
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .information h2 {
            font-size: 1.75em; /* Asegurado de que el tamaño sea el mismo que los otros h2 */
            color: #333; /* Color ajustado */
            margin-top: 0;
            text-align: center;
        }

        .information p {
            font-size: 16px;
            margin: 10px 0;
            line-height: 1.6;
        }

        /* Estilos para los enlaces a redes sociales */
        .social-icons {
            list-style: none;
            padding: 10px 0;
            text-align: center;
            margin-top: 40px; /* Espaciado superior para los íconos */
        }

        .social-icons li {
            display: inline-block;
            margin: 0 15px; /* Espaciado entre iconos */
        }

        .social-icons a {
            color: white;
            text-decoration: none;
            font-size: 18px; /* Tamaño ajustado */
            padding: 8px;
            border-radius: 50%;
            background-color: #8B0000;
            transition: transform 0.3s; /* Solo cambio en el tamaño al hacer hover */
        }

        /* Tamaño ajustado de las imágenes de redes sociales */
        .social-icons a img {
            width: 48px; /* Aumento del tamaño de las imágenes */
            height: 48px; /* Aumento del tamaño de las imágenes */
        }

        .social-icons a:hover {
            transform: scale(1.1); /* Se agranda un poco al pasar el mouse */
        }

        /* Estilos para el pie de página */
        footer {
            background-color: #8B0000;
            color: white;
            text-align: center;
            padding: 1em 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        footer .footer-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        footer .footer-container .social-icons {
            margin: 0;
            text-align: left;
        }

        footer .footer-container .info-container {
            margin-left: 20px;
            text-align: left;
        }

        /* Estilos para el copyright */
        footer p.copyright {
            margin-top: 20px;
            font-size: 12px;
            color: #ccc;
        }

        /* Estilos para las preguntas frecuentes (listas desplegables) */
        #ayuda li {
            cursor: pointer;
            list-style-type: none;
            background-color: #A52A2A;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
            text-align: left;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
        }

        #ayuda li:hover {
            background-color: #8B0000;
        }

        .respuesta {
            display: none;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 5px;
            margin-top: 5px;
            margin-left: auto;
            margin-right: auto;
            width: 80%; /* Ahora tiene el mismo margen que los formularios */
        }

        /* Mejoras visuales */
        #ayuda li + .respuesta {
            border: 1px solid #8B0000;
            margin-top: 10px;
        }

        .active{
            width: 30%;
            height: 30%;
        }

    </style>
</head>
<body>
    <header>
        <img src="logo.png" alt="Logo"> <!-- Asegúrate de tener el logo en la ruta especificada -->
        <h1>Biblioteca Escolar</h1>
    </header>

    <nav>
        <ul>
            <li><a href="#informacion">Informacion</a></li>
            <li><a href="#anuncios">Anuncios</a></li>
            <li><a href="#buscar">Buscar Libro</a></li>
            <li><a href="#agregar">Agregar Libro</a></li>
            <li><a href="#ayuda">Ayuda</a></li>
        </ul>
    </nav>

    <section id="informacion" class="information">
        <h2 id="info-title">Información</h2>
        <p>Esta página tiene como objetivo dar a conocer más información acerca de las características de los libros. Asimismo, permite agregar más libros.</p>
    </section>

    <main>
        <section id="anuncios">
            <h2 id="anuncios-title">Anuncios</h2>
            <div class="slides">
                <div class="slides-container">
                    <img src="anuncio.gif" alt="Anuncio 1" class="active">
                </div>
            </div>
        </section>

        <section id="buscar">
            <h2 id="buscar-title">Buscar Libro</h2>
            <form id="form-buscar">
                <label for="busqueda">Introduce el nombre del libro, autor, categoría, etc.:</label>
                <input type="text" id="busqueda" name="busqueda" placeholder="Ingresa términos de búsqueda">
                <button type="submit">Buscar</button>
                <div class="Libro"></div>
            </form>
            <div class="loading-dots">
                <span></span><span></span><span></span>
            </div>
            <div id="resultados-busqueda" class="results">
                <img src="cargar.gif" alt="Anuncio 2" class="active">
            </div> <!--Mostrar libro-->

        <section id="agregar">
            <h2 id="agregar-title">Agregar Libro</h2>
            <form id="form-agregar">
                <label for="nombre-libro">Nombre del libro:</label>
                <input type="text" id="nombre-libro" name="nombre-libro" required>

                <label for="autor">Autor:</label>
                <input type="text" id="autor" name="autor" required>

                <label for="editorial">Editorial:</label>
                <input type="text" id="editorial" name="editorial" required>

                <label for="publicacion">Fecha de Publicación:</label>
                <input type="date" id="publicacion" name="publicacion" required>

                <label for="codigo">Número de Serie:</label>
                <input type="text" id="codigo" name="codigo" required pattern="[a-z0-9]+">

                <label for="salon">Salón:</label>
                <input type="text" id="salon" name="salon" required>

                <label for="categoria">Categoría:</label>
                <select id="categoria" name="categoria" required>
                    <option value="aventura">Aventura</option>
                    <option value="biografia">Biografía</option>
                    <option value="ciencia-ficcion">Ciencia ficción</option>
                    <option value="clasicos">Clásicos</option>
                    <option value="cuentos">Cuentos</option>
                    <option value="desarrollo-personal">Desarrollo personal</option>
                    <option value="didacticos">Didácticos</option>
                    <option value="drama">Drama</option>
                    <option value="ensayo">Ensayo</option>
                    <option value="fantasia">Fantasía</option>
                    <option value="historia">Historia</option>
                    <option value="misterio">Misterio</option>
                    <option value="novela-historica">Novela histórica</option>
                    <option value="poesia">Poesía</option>
                    <option value="romance">Romance</option>
                    <option value="teatro">Teatro</option>
                    <option value="terror">Terror</option>
                    <option value="ficcion-juvenil">Ficción juvenil</option>
                    <option value="literatura-infantil">Literatura infantil</option>
                    <option value="libros-ilustrados">Libros ilustrados</option>
                </select>

                <button type="submit">Agregar</button>
            </form>
        </section>

        <section id="ayuda">
            <p style="font-size: 2em; color: #333;" id="faq-title">Preguntas frecuentes</p>

            <ul>
                <li onclick="toggleAnswer(0)">¿Qué es?</li>
                <div class="respuesta">
                    <p>Es una página acerca de registros de libros para realizar una búsqueda más precisa, con el objetivo de conocer más detalles acerca del libro y su ubicación.</p>
                </div>

                <li onclick="toggleAnswer(1)">¿Cómo funciona?</li>
                <div class="respuesta">
                    <p>De acuerdo con la búsqueda que realices, se mostrará información detallada acerca del libro y el salón donde se encuentra.</p>
                </div>

                <li onclick="toggleAnswer(2)">¿Cómo buscar un libro?</li>
                <div class="respuesta">
                    <p>1. Ingresa a la sección "Buscar Libro".<br>2. Introduce el nombre del libro, autor, editorial.<br>3. Espera el resultado de tu búsqueda.<br>4. Acude al salón indicado.<br>5. Pregunta por el libro y listo.</p>
                </div>

                <li onclick="toggleAnswer(3)">¿Cómo agregar un libro?</li>
                <div class="respuesta">
                    <p>1. Ingresa a la sección "Agregar Libro".<br>2. Llena los campos correspondientes.<br>3. Presiona "Agregar".<br>4. Espera a que cargue y listo.</p>
                </div>
            </ul>
        </section>

    </main>

    <footer>
        <div class="footer-container">
            <!-- Información adicional y enlaces a redes sociales -->
            <div class="info-container">
                <h2>Información Adicional</h2>
                <p>El sitio web proporciona un entendimiento excepcional del material incluido y sabe dónde encontrar información adicional. Puede fácilmente contestar preguntas sobre el contenido y los procedimientos usados para crear el sitio en la web.</p>
                <p>El sitio web tiene un atractivo excepcional y una presentación útil. Es fácil localizar todos los elementos importantes. El espacio en blanco, los elementos gráficos y/o el centrado son usados con efectividad.</p>
            </div>
            
            <div class="social-icons">
                <ul>
                    <li><a href="https://facebook.com" target="_blank"><img src="facebook.png" alt="Facebook"></a></li>
                    <li><a href="https://whatsapp.com" target="_blank"><img src="Whatsapp.png" alt="Twitter"></a></li>
                    <li><a href="https://instagram.com" target="_blank"><img src="insta.png" alt="Instagram"></a></li>
                </ul>
            </div>
        </div>
        <p class="copyright">© 2025 Biblioteca Escolar. Todos los derechos reservados.</p>
    </footer>

    <script>
            // Paso 1: Configurar cliente Supabase
            const supabase = supabase.createClient(
                "https://mxydejumvmtcyczhsnmw.supabase.co", // URL de tu proyecto Supabase
                "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im14eWRlanVtdm10Y3ljemhzbm13Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc3NzE5NDEsImV4cCI6MjA1MzM0Nzk0MX0.3MyW650iBh5BC53eJTqcqnV08oDPoJIbzVaDwXmTs4I" // Tu clave API
            );
        
            // Paso 2: Función para realizar la búsqueda de libros
            document.getElementById("form-buscar").addEventListener("submit", async function(event) {
                event.preventDefault();
        
                let query = document.getElementById("busqueda").value.toLowerCase();
        
                // Mostrar el icono de carga mientras se realiza la consulta
                document.querySelector(".loading-dots").style.display = "inline-block";
                document.getElementById("resultados-busqueda").innerHTML = ""; // Limpiar resultados previos
        
                try {
                    // Consultar la base de datos en Supabase
                    const { data: libros, error } = await supabase
                        .from('libros')  // Nombre de tu tabla en Supabase
                        .select('*')
                        .ilike('nombre', `%${query}%`)  // Buscar por nombre
                        .or(`autor.ilike.%${query}%,categoria.ilike.%${query}%`); // Buscar por autor o categoría
        
                    // Ocultar el icono de carga después de obtener los resultados
                    document.querySelector(".loading-dots").style.display = "none";
        
                    let resultadosDiv = document.getElementById("resultados-busqueda");
        
                    if (error) {
                        console.error("Error en la búsqueda:", error);
                        resultadosDiv.innerHTML = "<p>Hubo un error en la búsqueda. Intenta de nuevo.</p>";
                        return;
                    }
        
                    if (libros && libros.length > 0) {
                        libros.forEach(libro => {
                            let resultDiv = document.createElement("div");
                            resultDiv.classList.add("result");
                            resultDiv.innerHTML = `
                                <h3>${libro.nombre}</h3>
                                <p><strong>Autor:</strong> ${libro.autor}</p>
                                <p><strong>Editorial:</strong> ${libro.editorial}</p>
                                <p><strong>Publicación:</strong> ${libro.publicacion}</p>
                                <p><strong>Código:</strong> ${libro.codigo}</p>
                                <p><strong>Salón:</strong> ${libro.salon}</p>
                                <p><strong>Categoría:</strong> ${libro.categoria}</p>
                            `;
                            resultadosDiv.appendChild(resultDiv);
                        });
                    } else {
                        resultadosDiv.innerHTML = "<p>No se encontraron libros que coincidan con tu búsqueda.</p>";
                    }
                } catch (error) {
                    console.error("Error al buscar libros:", error);
                    document.querySelector(".loading-dots").style.display = "none";
                    document.getElementById("resultados-busqueda").innerHTML = "<p>Hubo un error al realizar la búsqueda. Intenta de nuevo.</p>";
                }
            });
        
            // Paso 3: Función para agregar libros a Supabase
            document.getElementById("form-agregar").addEventListener("submit", async function(event) {
                event.preventDefault();
        
                // Obtener los valores del formulario
                const nombreLibro = document.getElementById("nombre-libro").value;
                const autor = document.getElementById("autor").value;
                const editorial = document.getElementById("editorial").value;
                const publicacion = document.getElementById("publicacion").value;
                const codigo = document.getElementById("codigo").value;
                const salon = document.getElementById("salon").value;
                const categoria = document.getElementById("categoria").value;
        
                try {
                    // Insertar el libro en la base de datos de Supabase
                    const { data, error } = await supabase
                        .from('libros')  // Nombre de la tabla
                        .insert([{
                            nombre: nombreLibro,
                            autor: autor,
                            editorial: editorial,
                            publicacion: publicacion,
                            codigo: codigo,
                            salon: salon,
                            categoria: categoria
                        }]);
        
                    if (error) {
                        console.error("Error al agregar el libro:", error);
                        alert("Hubo un error al agregar el libro. Por favor, intenta nuevamente.");
                    } else {
                        alert("Libro agregado correctamente!");
                        // Limpiar el formulario
                        document.getElementById("form-agregar").reset();
                    }
                } catch (error) {
                    console.error("Error al agregar libro:", error);
                    alert("Hubo un error al agregar el libro. Por favor, intenta nuevamente.");
                }
            });
        
            // Paso 4: Función para mostrar/ocultar respuestas de preguntas frecuentes
            function toggleAnswer(index) {
                const answers = document.querySelectorAll('.respuesta');
                answers[index].style.display = answers[index].style.display === 'none' ? 'block' : 'none';
            }        
    </script>
</body>
</html>